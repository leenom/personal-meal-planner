<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leeseong's Meal Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', 'Plus Jakarta Sans', sans-serif;
            background-color: #F8FAFC; /* Light Slate 50 */
        }
        .card {
            background-color: white;
            border-radius: 1.25rem; /* ~20px */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            transition: all 0.3s ease-in-out;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.875rem 1.5rem; /* 14px 24px */
            border-radius: 0.75rem; /* 12px */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            width: 100%;
            border: 1px solid transparent;
        }
        .btn-primary {
            background-color: #2563EB; /* Blue 600 */
            color: white;
            box-shadow: 0 4px 14px rgba(37, 99, 235, 0.25);
        }
        .btn-primary:hover {
            background-color: #1D4ED8; /* Blue 700 */
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }
        .btn-secondary {
            background-color: #F1F5F9; /* Slate 100 */
            color: #0F172A; /* Slate 900 */
            border-color: #E2E8F0; /* Slate 200 */
        }
         .btn-secondary:hover {
            background-color: #E2E8F0; /* Slate 200 */
            transform: translateY(-2px);
        }
        .btn-tertiary {
            background-color: #10B981; /* Emerald 500 */
            color: white;
             box-shadow: 0 4px 14px rgba(16, 185, 129, 0.25);
        }
        .btn-tertiary:hover {
            background-color: #059669; /* Emerald 600 */
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }
        .loader {
            border: 4px solid #e2e8f0;
            border-top: 4px solid #2563EB;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media print {
            body { background-color: white; }
            body * { visibility: hidden; }
            #plan-output, #plan-output * { visibility: visible; }
            #plan-output { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: 1px solid #ccc; }
            #action-buttons { display: none; }
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <!-- Header -->
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-900 tracking-tight">Leeseong's Meal Planner</h1>
            <p class="mt-4 text-lg text-slate-500">ê°€ì¡±ì„ ìœ„í•œ ê±´ê°•í•œ ë§ì¶¤í˜• ì‹ë‹¨ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”.</p>
        </header>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Input Form -->
            <div class="lg:col-span-1">
                <div class="card sticky top-8">
                    <h2 class="flex items-center text-2xl font-bold mb-6 border-b border-slate-200 pb-4 text-slate-800">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 text-blue-600"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        ì‹ë‹¨ ì„¤ì •
                    </h2>
                    <form id="meal-plan-form">
                        <div class="space-y-6">
                            <!-- Family Composition -->
                            <div>
                                <label class="block text-md font-medium text-slate-600 mb-2">ê°€ì¡± êµ¬ì„±ì›</label>
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center">
                                        <label for="adults" class="mr-2 text-slate-500">ì–´ë¥¸</label>
                                        <input type="number" id="adults" value="2" min="1" class="w-20 p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div class="flex items-center">
                                        <label for="children" class="mr-2 text-slate-500">ì•„ì´</label>
                                        <input type="number" id="children" value="1" min="0" class="w-20 p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                </div>
                            </div>

                            <!-- Dietary Preferences -->
                            <div>
                                <label class="block text-md font-medium text-slate-600 mb-2">ì‹ë‹¨ ì„±í–¥</label>
                                <div class="grid grid-cols-2 gap-3">
                                    <label class="flex items-center p-3 bg-slate-50 rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-100"><input type="checkbox" id="pref-vegetarian" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3">ì±„ì‹</label>
                                    <label class="flex items-center p-3 bg-slate-50 rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-100"><input type="checkbox" id="pref-spicy" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3">ë§¤ìš´ ìŒì‹</label>
                                    <label class="flex items-center p-3 bg-slate-50 rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-100"><input type="checkbox" id="pref-seafood" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3">í•´ì‚°ë¬¼</label>
                                    <label class="flex items-center p-3 bg-slate-50 rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-100"><input type="checkbox" id="pref-kids-friendly" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3">ì•„ì´ë“¤ ì…ë§›</label>
                                </div>
                            </div>

                            <!-- Health Goal -->
                            <div>
                                <label for="health-goal" class="block text-md font-medium text-slate-600 mb-2">ì£¼ìš” ëª©í‘œ</label>
                                <select id="health-goal" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                                    <option value="general">ê· í˜• ì¡íŒ ì˜ì–‘</option>
                                    <option value="weight-loss">ì²´ì¤‘ ì¡°ì ˆ</option>
                                    <option value="muscle-gain">ê·¼ë ¥ ê°•í™”</option>
                                </select>
                            </div>

                            <!-- Meal Frequency -->
                            <div>
                                <label class="block text-md font-medium text-slate-600 mb-2">ì‹ì‚¬ íšŸìˆ˜</label>
                                <div class="flex space-x-4">
                                    <label class="flex items-center"><input type="radio" name="meal-freq" value="3" checked class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mr-2">í•˜ë£¨ 3ë¼</label>
                                    <label class="flex items-center"><input type="radio" name="meal-freq" value="2" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500 mr-2">í•˜ë£¨ 2ë¼</label>
                                </div>
                            </div>
                        </div>

                        <!-- Generate Buttons -->
                        <div class="mt-8 pt-6 border-t border-slate-200 space-y-3">
                             <button type="button" id="generate-today-btn" class="btn btn-tertiary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M3 3h18v18H3zM12 8v8m-4-4h8"/></svg>
                                ì˜¤ëŠ˜ ë­ ë¨¹ì§€?
                            </button>
                             <button type="button" id="generate-week-btn" class="btn btn-secondary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line><path d="M8 14h.01"></path><path d="M12 14h.01"></path><path d="M16 14h.01"></path><path d="M8 18h.01"></path><path d="M12 18h.01"></path><path d="M16 18h.01"></path></svg>
                                ì£¼ê°„ ì‹ë‹¨ ìƒì„±
                            </button>
                            <button type="button" id="generate-month-btn" class="btn btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2v0Z"/><path d="M12 8v8"/><path d="m8.5 10.5 7 3-7 3Z"/></svg>
                                ì›”ê°„ ì‹ë‹¨ ìƒì„±
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Output Display -->
            <div class="lg:col-span-2">
                <div class="card min-h-[600px]">
                    <div class="flex justify-between items-center mb-6 border-b border-slate-200 pb-4">
                         <h2 id="result-title" class="text-2xl font-bold text-slate-800">ë‚˜ì˜ ì‹ë‹¨í‘œ</h2>
                         <div id="action-buttons" class="hidden">
                            <button id="print-btn" class="btn btn-secondary !w-auto">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                                ì¸ì‡„í•˜ê¸°
                            </button>
                         </div>
                    </div>
                   
                    <div id="plan-output" class="overflow-x-auto">
                        <div id="initial-message" class="flex flex-col items-center justify-center text-center h-96">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-20 h-20 text-slate-300 mb-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" ><path d="M15.5 2H8.6c-.4 0-.8.2-1.1.5-.3.3-.5.7-.5 1.1V21c0 .6.4 1 1 1h12c.6 0 1-.4 1-1V8.5L15.5 2z"/><path d="M15 2v5h5"/><path d="M10 16s.8-1 2-1 2 1 2 1"/><path d="M10 12s.8-1 2-1 2 1 2 1"/></svg>
                            <h3 class="text-xl font-semibold text-slate-600">ì‹ë‹¨ì„ ë§Œë“¤ì–´ ë³¼ê¹Œìš”?</h3>
                            <p class="text-slate-500 mt-2">ì™¼ìª½ì—ì„œ ì›í•˜ëŠ” ì„¤ì •ì„ ì„ íƒí•˜ê³ <br>ë²„íŠ¼ì„ ëˆŒëŸ¬ ë‚˜ë§Œì˜ ì‹ë‹¨ì„ ìƒì„±í•´ ë³´ì„¸ìš”.</p>
                        </div>
                        <div id="loading-spinner" class="hidden flex items-center justify-center h-96">
                            <div class="loader"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- RECIPE DATABASE (EXPANDED) ---
        const recipes = {
            breakfast: [
                { name: 'í˜„ë¯¸ë°¥ê³¼ ë¯¸ì—­êµ­', tags: ['general', 'kids-friendly'] },
                { name: 'ìŠ¤í¬ë¨ë¸” ì—ê·¸ì™€ í†µë°€ë¹µ', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ì˜¤íŠ¸ë°€ê³¼ ê³¼ì¼', tags: ['general', 'weight-loss', 'vegetarian', 'kids-friendly'] },
                { name: 'ë‹­ê°€ìŠ´ì‚´ ìƒŒë“œìœ„ì¹˜', tags: ['general', 'muscle-gain', 'weight-loss'] },
                { name: 'ê·¸ë¦­ ìš”ê±°íŠ¸ì™€ ê²¬ê³¼ë¥˜', tags: ['general', 'muscle-gain', 'weight-loss', 'vegetarian'] },
                { name: 'ê°„ë‹¨í•œ ê¹€ë°¥', tags: ['general', 'kids-friendly'] },
                { name: 'ë‘ë¶€ ìœ ë¶€ì´ˆë°¥', tags: ['general', 'weight-loss', 'vegetarian', 'kids-friendly'] },
                { name: 'ëˆ„ë£½ì§€ì™€ ê³„ë€ì°œ', tags: ['general', 'kids-friendly'] },
                { name: 'ì „ë³µì£½', tags: ['general', 'kids-friendly', 'seafood'] },
                { name: 'ì•¼ì±„ì£½', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'í”„ë Œì¹˜ í† ìŠ¤íŠ¸', tags: ['general', 'kids-friendly'] },
                { name: 'ê³¼ì¼ ìŠ¤ë¬´ë””', tags: ['general', 'weight-loss', 'vegetarian', 'kids-friendly'] },
                { name: 'ë¯¸ìˆ«ê°€ë£¨', tags: ['general', 'vegetarian'] },
                { name: 'ë–¡êµ­', tags: ['general', 'kids-friendly'] },
                { name: 'ì‹œë¦¬ì–¼ê³¼ ìš°ìœ ', tags: ['general', 'kids-friendly'] }
            ],
            lunch_dinner: [
                 // ì°Œê°œ/íƒ•ë¥˜ (Stews/Soups)
                { name: 'ê¹€ì¹˜ì°Œê°œì™€ ì¡ê³¡ë°¥', tags: ['general', 'spicy'] },
                { name: 'ëœì¥ì°Œê°œì™€ ë³´ë¦¬ë°¥', tags: ['general', 'kids-friendly'] },
                { name: 'ìˆœë‘ë¶€ì°Œê°œ', tags: ['general', 'spicy', 'vegetarian', 'seafood'] },
                { name: 'ë¶€ëŒ€ì°Œê°œ', tags: ['general', 'spicy'] },
                { name: 'ë™íƒœì°Œê°œ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ì•Œíƒ•', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ê°ìíƒ•', tags: ['general', 'spicy', 'muscle-gain'] },
                { name: 'ì„¤ë íƒ•', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ê°ˆë¹„íƒ•', tags: ['general', 'muscle-gain'] },
                { name: 'ìœ¡ê°œì¥', tags: ['general', 'spicy', 'muscle-gain'] },
                { name: 'ì–´ë¬µíƒ•', tags: ['general', 'kids-friendly', 'seafood'] },
                { name: 'ì½©ë¹„ì§€ì°Œê°œ', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'ì²­êµ­ì¥', tags: ['general'] },
                { name: 'ë‹­ë³¶ìŒíƒ•', tags: ['general', 'spicy', 'muscle-gain'] },
                { name: 'ì‚¼ê³„íƒ•', tags: ['general', 'muscle-gain'] },
                { name: 'ì¶”ì–´íƒ•', tags: ['general'] },

                // ë³¶ìŒ/êµ¬ì´/ì¡°ë¦¼ë¥˜ (Stir-fried/Grilled/Braised)
                { name: 'ì†Œë¶ˆê³ ê¸° ë®ë°¥', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ì œìœ¡ë³¶ìŒê³¼ ìŒˆì±„ì†Œ', tags: ['general', 'muscle-gain', 'spicy'] },
                { name: 'ì˜¤ì§•ì–´ë³¶ìŒ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ì­ˆê¾¸ë¯¸ë³¶ìŒ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ë‚™ì§€ë³¶ìŒ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ë‹­ê°ˆë¹„', tags: ['general', 'muscle-gain', 'spicy'] },
                { name: 'ì˜¤ë¦¬ë¶ˆê³ ê¸°', tags: ['general', 'muscle-gain'] },
                { name: 'ê³ ë“±ì–´ êµ¬ì´ì™€ ìŒ€ë°¥', tags: ['general', 'seafood'] },
                { name: 'ì‚¼ì¹˜ êµ¬ì´', tags: ['general', 'seafood', 'kids-friendly'] },
                { name: 'LAê°ˆë¹„êµ¬ì´', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ë–¡ê°ˆë¹„', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ì‚¼ê²¹ì‚´ êµ¬ì´', tags: ['general', 'muscle-gain'] },
                { name: 'ë”ë•êµ¬ì´', tags: ['general', 'vegetarian', 'spicy'] },
                { name: 'ì½”ë‹¤ë¦¬ì¡°ë¦¼', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ê°ˆì¹˜ì¡°ë¦¼', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ë‘ë¶€ì¡°ë¦¼', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'ê³„ë€ì¥ì¡°ë¦¼', tags: ['general', 'kids-friendly'] },
                
                // ë°¥/ë©´ë¥˜ (Rice/Noodles)
                { name: 'ë¹„ë¹”ë°¥', tags: ['general', 'weight-loss', 'vegetarian', 'spicy'] },
                { name: 'ê¹€ì¹˜ë³¶ìŒë°¥', tags: ['general', 'spicy'] },
                { name: 'ìƒˆìš°ë³¶ìŒë°¥', tags: ['general', 'seafood', 'kids-friendly'] },
                { name: 'ì˜¤ë¯€ë¼ì´ìŠ¤', tags: ['general', 'kids-friendly'] },
                { name: 'ì¹´ë ˆë¼ì´ìŠ¤', tags: ['general', 'kids-friendly'] },
                { name: 'ì§œì¥ë°¥', tags: ['general', 'kids-friendly'] },
                { name: 'íšŒë®ë°¥', tags: ['general', 'weight-loss', 'seafood', 'spicy'] },
                { name: 'ì•Œë°¥', tags: ['general', 'seafood', 'kids-friendly'] },
                { name: 'ì”ì¹˜êµ­ìˆ˜', tags: ['general'] },
                { name: 'ë¹„ë¹”êµ­ìˆ˜', tags: ['general', 'spicy'] },
                { name: 'ì¹¼êµ­ìˆ˜', tags: ['general', 'seafood'] },
                { name: 'ì½©êµ­ìˆ˜', tags: ['general', 'vegetarian'] },
                { name: 'ë¼ë©´', tags: ['general', 'spicy'] },
                { name: 'ì§œì¥ë©´', tags: ['general'] },
                { name: 'ì§¬ë½•', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ìŒ€êµ­ìˆ˜', tags: ['general', 'seafood'] },
                { name: 'ë³¶ìŒìš°ë™', tags: ['general', 'seafood'] },
                
                // ì°œ/ê¸°íƒ€ í•œì‹ (Steamed/Other Korean)
                { name: 'ì°œë‹­', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ì•„ê·€ì°œ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'í•´ë¬¼ì°œ', tags: ['general', 'spicy', 'seafood'] },
                { name: 'ë¼ì§€ê³ ê¸° ìˆ˜ìœ¡', tags: ['general', 'muscle-gain'] },
                { name: 'ì¡±ë°œ', tags: ['general', 'muscle-gain'] },
                { name: 'í•´ë¬¼íŒŒì „', tags: ['general', 'seafood'] },
                { name: 'ê¹€ì¹˜ì „', tags: ['general', 'spicy'] },
                { name: 'ì¡ì±„', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'ê³¨ë±…ì´ë¬´ì¹¨', tags: ['general', 'spicy'] },
                { name: 'ë¬µì€ì§€ ê¹€ì¹˜ì°œ', tags: ['general', 'spicy'] },
                { name: 'ë‹­ë°±ìˆ™', tags: ['general', 'muscle-gain'] },
                
                // ì–‘ì‹/ê¸°íƒ€ (Western/Others)
                { name: 'í† ë§ˆí†  í•´ì‚°ë¬¼ íŒŒìŠ¤íƒ€', tags: ['general', 'seafood'] },
                { name: 'í¬ë¦¼ ë²„ì„¯ ë¦¬ì¡°ë˜', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'ì•Œë¦¬ì˜¤ ì˜¬ë¦¬ì˜¤', tags: ['general', 'vegetarian'] },
                { name: 'ë´‰ê³¨ë ˆ íŒŒìŠ¤íƒ€', tags: ['general', 'seafood'] },
                { name: 'ë¼ìëƒ', tags: ['general', 'muscle-gain'] },
                { name: 'í•¨ë°•ìŠ¤í…Œì´í¬', tags: ['general', 'muscle-gain', 'kids-friendly'] },
                { name: 'ëˆê¹ŒìŠ¤', tags: ['general', 'kids-friendly'] },
                { name: 'ì—°ì–´ ìŠ¤í…Œì´í¬ì™€ ì•„ìŠ¤íŒŒë¼ê±°ìŠ¤', tags: ['general', 'weight-loss', 'muscle-gain', 'seafood'] },
                { name: 'ì†Œê³ ê¸° ìŠ¤í…Œì´í¬', tags: ['general', 'muscle-gain'] },
                { name: 'ëª©ì‚´ ìŠ¤í…Œì´í¬', tags: ['general', 'muscle-gain'] },
                { name: 'ê³ ë¥´ê³¤ì¡¸ë¼ í”¼ì', tags: ['general', 'vegetarian', 'kids-friendly'] },
                { name: 'ë§ˆë¥´ê²Œë¦¬ë”° í”¼ì', tags: ['general', 'vegetarian'] },
                { name: 'ì›”ë‚¨ìŒˆ', tags: ['general', 'weight-loss', 'vegetarian'] },
                { name: 'ë§ˆíŒŒë‘ë¶€ ë®ë°¥', tags: ['general', 'spicy', 'vegetarian'] },
                { name: 'íƒ•ìˆ˜ìœ¡', tags: ['general'] },
                { name: 'ê¹í’ê¸°', tags: ['general', 'spicy'] },
                { name: 'ê¿”ë°”ë¡œìš°', tags: ['general'] },
                { name: 'ì–‘ì¥í”¼', tags: ['general', 'seafood'] },

                // ê±´ê°•ì‹/ì±„ì‹ (Healthy/Vegetarian)
                { name: 'ë‹­ê°€ìŠ´ì‚´ ìƒëŸ¬ë“œ', tags: ['weight-loss', 'muscle-gain', 'vegetarian'] },
                { name: 'ë¦¬ì½”íƒ€ì¹˜ì¦ˆ ìƒëŸ¬ë“œ', tags: ['weight-loss', 'vegetarian', 'kids-friendly'] },
                { name: 'ë‘ë¶€ ìŠ¤í…Œì´í¬', tags: ['weight-loss', 'muscle-gain', 'vegetarian'] },
                { name: 'ë²„ì„¯ ê°•ì •', tags: ['vegetarian', 'kids-friendly'] },
                { name: 'ì±„ì‹ ì¡ì±„', tags: ['vegetarian', 'kids-friendly'] },
                { name: 'ì½©ê³ ê¸° íƒ•ìˆ˜', tags: ['vegetarian', 'muscle-gain'] },
                { name: 'ì•¼ì±„ íŠ€ê¹€', tags: ['vegetarian'] },
                { name: 'ê¶ì¤‘ë–¡ë³¶ì´', tags: ['general', 'kids-friendly'] },
                { name: 'ì½¥ ìƒëŸ¬ë“œ', tags: ['weight-loss', 'muscle-gain']}
            ]
        };

        const form = document.getElementById('meal-plan-form');
        const outputDiv = document.getElementById('plan-output');
        const initialMessage = document.getElementById('initial-message');
        const loadingSpinner = document.getElementById('loading-spinner');
        const actionButtons = document.getElementById('action-buttons');
        const printBtn = document.getElementById('print-btn');
        const resultTitle = document.getElementById('result-title');

        const monthBtn = document.getElementById('generate-month-btn');
        const weekBtn = document.getElementById('generate-week-btn');
        const todayBtn = document.getElementById('generate-today-btn');

        monthBtn.addEventListener('click', () => prepareAndGenerate(30));
        weekBtn.addEventListener('click', () => prepareAndGenerate(7));
        todayBtn.addEventListener('click', () => prepareAndGenerate(1));
        
        printBtn.addEventListener('click', () => {
            window.print();
        });
        
        function prepareAndGenerate(days) {
            initialMessage.classList.add('hidden');
            outputDiv.innerHTML = ''; // Clear previous results
            outputDiv.appendChild(loadingSpinner);
            loadingSpinner.classList.remove('hidden');
            actionButtons.classList.add('hidden');
            resultTitle.textContent = 'ë‚˜ì˜ ì‹ë‹¨í‘œ'; // Reset title

            // Simulate AI thinking time
            setTimeout(() => {
                generateMealPlan(days);
            }, 1000);
        }

        function generateMealPlan(numberOfDays) {
            // 1. Get user inputs
            const healthGoal = document.getElementById('health-goal').value;
            const mealFreq = document.querySelector('input[name="meal-freq"]:checked').value;
            const prefs = {
                vegetarian: document.getElementById('pref-vegetarian').checked,
                spicy: document.getElementById('pref-spicy').checked,
                seafood: document.getElementById('pref-seafood').checked,
                'kids-friendly': document.getElementById('pref-kids-friendly').checked,
            };

            // 2. Filter recipes based on inputs
            let filteredBreakfast = [...recipes.breakfast];
            let filteredLunchDinner = [...recipes.lunch_dinner];

            // Primary Goal Filter
            if (healthGoal !== 'general') {
                filteredBreakfast = filteredBreakfast.filter(r => r.tags.includes(healthGoal) || r.tags.includes('general'));
                filteredLunchDinner = filteredLunchDinner.filter(r => r.tags.includes(healthGoal) || r.tags.includes('general'));
            }

            // Preference Filter
            const activePrefs = Object.keys(prefs).filter(pref => prefs[pref]);
            if (activePrefs.length > 0) {
                filteredBreakfast = filteredBreakfast.filter(r => activePrefs.every(pref => r.tags.includes(pref)));
                filteredLunchDinner = filteredLunchDinner.filter(r => activePrefs.every(pref => r.tags.includes(pref)));
            }
            
            // Check if there are enough recipes
            if (filteredBreakfast.length === 0 || filteredLunchDinner.length < 2) {
                 loadingSpinner.classList.add('hidden');
                 outputDiv.innerHTML = `<div class="text-center p-8 text-red-600 bg-red-50 rounded-lg">
                    <h3 class="font-bold text-lg mb-2">ë ˆì‹œí”¼ê°€ ë¶€ì¡±í•´ìš”!</h3>
                    <p>ì„ íƒí•˜ì‹  ì¡°ê±´ì— ë§ëŠ” ì‹ë‹¨ì„ ë§Œë“¤ ìˆ˜ ì—†ì–´ìš”. ë‹¤ë¥¸ ì˜µì…˜ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.<br/>(ì˜ˆ: 'ì±„ì‹'ê³¼ 'í•´ì‚°ë¬¼'ì„ ë™ì‹œì— ì„ íƒí•˜ë©´ ë©”ë‰´ê°€ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</p>
                 </div>`;
                 return;
            }

            // 3. Generate plan
            let plan = [];
            let lastLunchDinner = '';
            for (let i = 1; i <= numberOfDays; i++) {
                const dayPlan = { day: i };
                
                dayPlan.breakfast = getRandomItem(filteredBreakfast).name;

                if (mealFreq === '3') {
                     let lunch;
                    do {
                        lunch = getRandomItem(filteredLunchDinner).name;
                    } while (lunch === lastLunchDinner);
                    dayPlan.lunch = lunch;
                    lastLunchDinner = lunch;
                } else {
                    dayPlan.lunch = 'â€”';
                }

                let dinner;
                do {
                    dinner = getRandomItem(filteredLunchDinner).name;
                } while (dinner === lastLunchDinner);
                dayPlan.dinner = dinner;
                lastLunchDinner = dinner;
                
                plan.push(dayPlan);
            }

            // 4. Display the plan
            displayPlan(plan, mealFreq, numberOfDays);
        }

        function getRandomItem(arr) {
            if (arr.length === 0) return { name: 'ì¶”ì²œ ë©”ë‰´ ì—†ìŒ' };
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function displayPlan(plan, mealFreq, numberOfDays) {
            loadingSpinner.classList.add('hidden');
            
            if (numberOfDays === 1) {
                resultTitle.textContent = "âœ¨ ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë©”ë‰´";
            } else {
                resultTitle.textContent = `ğŸ“ ${numberOfDays}ì¼ ì‹ë‹¨ ê³„íš`;
            }
            
            let tableHTML = `
                <table class="w-full text-sm text-left text-slate-500">
                    <thead class="text-xs text-slate-700 bg-slate-100 rounded-t-lg">
                        <tr>
                            <th scope="col" class="py-3 px-4 w-1/12 text-center rounded-tl-lg">ë‚ ì§œ</th>
                            <th scope="col" class="py-3 px-4 w-3/12">ì•„ì¹¨</th>
                            ${mealFreq === '3' ? '<th scope="col" class="py-3 px-4 w-4/12">ì ì‹¬</th>' : ''}
                            <th scope="col" class="py-3 px-4 w-4/12 rounded-tr-lg">ì €ë…</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            plan.forEach(dayData => {
                let weekDay, dayClass, dateCellContent;

                if (numberOfDays === 1) {
                    const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                    const todayIndex = new Date().getDay();
                    weekDay = weekdays[todayIndex];
                    dayClass = 'bg-amber-50';
                    dateCellContent = `ì˜¤ëŠ˜`;
                } else {
                    weekDay = getWeekday(dayData.day);
                    dayClass = 'bg-white';
                    if (weekDay === 'í† ') dayClass = 'bg-sky-50';
                    if (weekDay === 'ì¼') dayClass = 'bg-rose-50';
                    dateCellContent = `${dayData.day}ì¼`;
                }

                tableHTML += `
                    <tr class="${dayClass} border-b border-slate-200">
                        <td class="py-4 px-4 font-bold text-slate-900 text-center">
                            ${dateCellContent}
                            <span class="block text-xs font-normal text-slate-500">${weekDay}</span>
                        </td>
                        <td class="py-4 px-4">${dayData.breakfast}</td>
                        ${mealFreq === '3' ? `<td class="py-4 px-4">${dayData.lunch}</td>` : ''}
                        <td class="py-4 px-4">${dayData.dinner}</td>
                    </tr>
                `;
            });

            tableHTML += `</tbody></table>`;
            outputDiv.innerHTML = tableHTML;
            actionButtons.classList.remove('hidden');
        }

        function getWeekday(dayOfMonth) {
            // Assuming the month starts on a Monday for simplicity
            const dayIndex = (dayOfMonth - 1) % 7;
            const weekdays = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
            return weekdays[dayIndex];
        }
    </script>
</body>
</html>

